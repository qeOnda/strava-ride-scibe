"use strict";var g=Object.create;var f=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var l=Object.getPrototypeOf,K=Object.prototype.hasOwnProperty;var b=(r,e)=>{for(var t in e)f(r,t,{get:e[t],enumerable:!0})},u=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of E(e))!K.call(r,o)&&o!==t&&f(r,o,{get:()=>e[o],enumerable:!(i=v(e,o))||i.enumerable});return r};var y=(r,e,t)=>(t=r!=null?g(l(r)):{},u(e||!r||!r.__esModule?f(t,"default",{value:r,enumerable:!0}):t,r)),q=r=>u(f({},"__esModule",{value:!0}),r);var P={};b(P,{decrypt:()=>x,deriveKey:()=>c,encrypt:()=>w});module.exports=q(P);var h=y(require("crypto"));var m=y(require("crypto")),c=r=>{if(Buffer.isBuffer(r)){if(r.length===32)return r;throw new Error("Key must be 32 bytes for AES-256")}return m.createHash("sha256").update(String(r)).digest()};var x=({encryptedText:r,key:e})=>{if(!e)throw new Error("decrypt: 'key' is required");if(!r)throw new Error("decrypt: 'text' is required");let t=c(e),i=r.split(":");if(i.length<2)throw new Error("decrypt: invalid ciphertext format, expected 'iv:ciphertext'");let o=i[0],n=i.slice(1).join(":");try{let p=Buffer.from(o,"hex"),B=Buffer.from(n,"hex"),a=h.createDecipheriv("aes-256-cbc",t,p),d=a.update(B,void 0,"utf8");return d+=a.final("utf8"),d}catch(p){throw new Error(`decrypt: failed to decrypt text - ${p instanceof Error?p.message:"unknown error"}`)}};var s=y(require("crypto"));var w=({text:r,key:e})=>{if(!e)throw new Error("encrypt: 'key' is required");if(!r)throw new Error("encrypt: 'text' is required");let t=c(e),i=s.randomBytes(16),o=s.createCipheriv("aes-256-cbc",t,i),n=o.update(r,"utf8","hex");return n+=o.final("hex"),i.toString("hex")+":"+n};0&&(module.exports={decrypt,deriveKey,encrypt});
